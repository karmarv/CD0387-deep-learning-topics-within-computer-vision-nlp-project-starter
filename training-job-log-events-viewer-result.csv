timestamp,message
1657559936234,bash: cannot set terminal process group (-1): Inappropriate ioctl for device
1657559936234,bash: no job control in this shell
1657559937234,"2022-07-11 17:18:56,604 sagemaker-training-toolkit INFO     Imported framework sagemaker_pytorch_container.training"
1657559937234,"2022-07-11 17:18:56,629 sagemaker_pytorch_container.training INFO     Block until all host DNS lookups succeed."
1657559937234,"2022-07-11 17:18:56,637 sagemaker_pytorch_container.training INFO     Invoking user training script."
1657559938235,"2022-07-11 17:18:57,257 sagemaker-training-toolkit INFO     Invoking user script"
1657559938235,Training Env:
1657559938236,"{
    ""additional_framework_parameters"": {},
    ""channel_input_dirs"": {
        ""train"": ""/opt/ml/input/data/train""
    },
    ""current_host"": ""algo-1"",
    ""framework_module"": ""sagemaker_pytorch_container.training:main"",
    ""hosts"": [
        ""algo-1""
    ],
    ""hyperparameters"": {
        ""batch_size"": ""4"",
        ""epochs"": ""2"",
        ""lr"": ""0.005374899793978716""
    },
    ""input_config_dir"": ""/opt/ml/input/config"",
    ""input_data_config"": {
        ""train"": {
            ""TrainingInputMode"": ""File"",
            ""S3DistributionType"": ""FullyReplicated"",
            ""RecordWrapperType"": ""None""
        }
    },
    ""input_dir"": ""/opt/ml/input"",
    ""is_master"": true,
    ""job_name"": ""pytorch-training-2022-07-11-17-13-07-784"",
    ""log_level"": 20,
    ""master_hostname"": ""algo-1"",
    ""model_dir"": ""/opt/ml/model"",
    ""module_dir"": ""s3://sagemaker-us-east-1-841424068653/pytorch-training-2022-07-11-17-13-07-784/source/sourcedir.tar.gz"",
    ""module_name"": ""train_model"",
    ""network_interface_name"": ""eth0"",
    ""num_cpus"": 8,
    ""num_gpus"": 1,
    ""output_data_dir"": ""/opt/ml/output/data"",
    ""output_dir"": ""/opt/ml/output"",
    ""output_intermediate_dir"": ""/opt/ml/output/intermediate"",
    ""resource_config"": {
        ""current_host"": ""algo-1"",
        ""current_instance_type"": ""ml.p3.2xlarge"",
        ""current_group_name"": ""homogeneousCluster"",
        ""hosts"": [
            ""algo-1""
        ],
        ""instance_groups"": [
            {
                ""instance_group_name"": ""homogeneousCluster"",
                ""instance_type"": ""ml.p3.2xlarge"",
                ""hosts"": [
                    ""algo-1""
                ]
            }
        ],
        ""network_interface_name"": ""eth0""
    },
    ""user_entry_point"": ""train_model.py"""
1657559938236,}
1657559938236,Environment variables:
1657559938236,"SM_HOSTS=[""algo-1""]"
1657559938236,SM_NETWORK_INTERFACE_NAME=eth0
1657559938236,"SM_HPS={""batch_size"":""4"",""epochs"":""2"",""lr"":""0.005374899793978716""}"
1657559938236,SM_USER_ENTRY_POINT=train_model.py
1657559938236,SM_FRAMEWORK_PARAMS={}
1657559938236,"SM_RESOURCE_CONFIG={""current_group_name"":""homogeneousCluster"",""current_host"":""algo-1"",""current_instance_type"":""ml.p3.2xlarge"",""hosts"":[""algo-1""],""instance_groups"":[{""hosts"":[""algo-1""],""instance_group_name"":""homogeneousCluster"",""instance_type"":""ml.p3.2xlarge""}],""network_interface_name"":""eth0""}"
1657559938236,"SM_INPUT_DATA_CONFIG={""train"":{""RecordWrapperType"":""None"",""S3DistributionType"":""FullyReplicated"",""TrainingInputMode"":""File""}}"
1657559938236,SM_OUTPUT_DATA_DIR=/opt/ml/output/data
1657559938236,"SM_CHANNELS=[""train""]"
1657559938236,SM_CURRENT_HOST=algo-1
1657559938236,SM_MODULE_NAME=train_model
1657559938236,SM_LOG_LEVEL=20
1657559938236,SM_FRAMEWORK_MODULE=sagemaker_pytorch_container.training:main
1657559938236,SM_INPUT_DIR=/opt/ml/input
1657559938236,SM_INPUT_CONFIG_DIR=/opt/ml/input/config
1657559938236,SM_OUTPUT_DIR=/opt/ml/output
1657559938236,SM_NUM_CPUS=8
1657559938236,SM_NUM_GPUS=1
1657559938236,SM_MODEL_DIR=/opt/ml/model
1657559938237,SM_MODULE_DIR=s3://sagemaker-us-east-1-841424068653/pytorch-training-2022-07-11-17-13-07-784/source/sourcedir.tar.gz
1657559938237,"SM_TRAINING_ENV={""additional_framework_parameters"":{},""channel_input_dirs"":{""train"":""/opt/ml/input/data/train""},""current_host"":""algo-1"",""framework_module"":""sagemaker_pytorch_container.training:main"",""hosts"":[""algo-1""],""hyperparameters"":{""batch_size"":""4"",""epochs"":""2"",""lr"":""0.005374899793978716""},""input_config_dir"":""/opt/ml/input/config"",""input_data_config"":{""train"":{""RecordWrapperType"":""None"",""S3DistributionType"":""FullyReplicated"",""TrainingInputMode"":""File""}},""input_dir"":""/opt/ml/input"",""is_master"":true,""job_name"":""pytorch-training-2022-07-11-17-13-07-784"",""log_level"":20,""master_hostname"":""algo-1"",""model_dir"":""/opt/ml/model"",""module_dir"":""s3://sagemaker-us-east-1-841424068653/pytorch-training-2022-07-11-17-13-07-784/source/sourcedir.tar.gz"",""module_name"":""train_model"",""network_interface_name"":""eth0"",""num_cpus"":8,""num_gpus"":1,""output_data_dir"":""/opt/ml/output/data"",""output_dir"":""/opt/ml/output"",""output_intermediate_dir"":""/opt/ml/output/intermediate"",""resource_config"":{""current_group_name"":""homogeneousCluster"",""current_host"":""algo-1"",""current_instance_type"":""ml.p3.2xlarge"",""hosts"":[""algo-1""],""instance_groups"":[{""hosts"":[""algo-1""],""instance_group_name"":""homogeneousCluster"",""instance_type"":""ml.p3.2xlarge""}],""network_interface_name"":""eth0""},""user_entry_point"":""train_model.py""}"
1657559938237,"SM_USER_ARGS=[""--batch_size"",""4"",""--epochs"",""2"",""--lr"",""0.005374899793978716""]"
1657559938237,SM_OUTPUT_INTERMEDIATE_DIR=/opt/ml/output/intermediate
1657559938237,SM_CHANNEL_TRAIN=/opt/ml/input/data/train
1657559938237,SM_HP_BATCH_SIZE=4
1657559938237,SM_HP_EPOCHS=2
1657559938237,SM_HP_LR=0.005374899793978716
1657559938237,PYTHONPATH=/opt/ml/code:/opt/conda/bin:/opt/conda/lib/python36.zip:/opt/conda/lib/python3.6:/opt/conda/lib/python3.6/lib-dynload:/opt/conda/lib/python3.6/site-packages
1657559938237,Invoking script with the following command:
1657559938237,/opt/conda/bin/python3.6 train_model.py --batch_size 4 --epochs 2 --lr 0.005374899793978716
1657559941238,[2022-07-11 17:19:00.424 algo-1:26 INFO utils.py:27] RULE_JOB_STOP_SIGNAL_FILENAME: None
1657559941238,[2022-07-11 17:19:00.551 algo-1:26 INFO profiler_config_parser.py:102] Using config at /opt/ml/input/config/profilerconfig.json.
1657559941238,Running on Device cuda:0
1657559947240,[2022-07-11 17:19:07.038 algo-1:26 INFO json_config.py:91] Creating hook from json_config at /opt/ml/input/config/debughookconfig.json.
1657559947240,[2022-07-11 17:19:07.040 algo-1:26 INFO hook.py:201] tensorboard_dir has not been set for the hook. SMDebug will not be exporting tensorboard summaries.
1657559947240,[2022-07-11 17:19:07.042 algo-1:26 INFO hook.py:255] Saving to /opt/ml/output/tensors
1657559947240,[2022-07-11 17:19:07.043 algo-1:26 INFO state_store.py:77] The checkpoint config file /opt/ml/input/config/checkpointconfig.json does not exist.
1657559947240,[2022-07-11 17:19:07.059 algo-1:26 INFO hook.py:591] name:fc.0.weight count_params:262144
1657559947240,[2022-07-11 17:19:07.059 algo-1:26 INFO hook.py:591] name:fc.0.bias count_params:512
1657559947240,[2022-07-11 17:19:07.060 algo-1:26 INFO hook.py:591] name:fc.2.weight count_params:68096
1657559947240,[2022-07-11 17:19:07.060 algo-1:26 INFO hook.py:591] name:fc.2.bias count_params:133
1657559947240,[2022-07-11 17:19:07.061 algo-1:26 INFO hook.py:593] Total Trainable Params: 330885
1657559947240,4
1657559948241,Start Model Training
1657559948241,"[2022-07-11 17:19:07.636 algo-1:26 INFO hook.py:425] Monitoring the collections: relu_input, CrossEntropyLoss_output_0, losses, gradients"
1657559948241,[2022-07-11 17:19:07.638 algo-1:26 INFO python_profiler.py:182] Dumping cProfile stats to /opt/ml/output/profiler/framework/pytorch/cprofile/26-algo-1/prestepzero-*-start-1657559940551828.5_train-0-stepstart-1657559947638060.0/python_stats.
1657559948241,[2022-07-11 17:19:07.656 algo-1:26 INFO hook.py:488] Hook is writing from the hook with pid: 26
1657559957244,[2022-07-11 17:19:17.108 algo-1:26 INFO python_profiler.py:182] Dumping cProfile stats to /opt/ml/output/profiler/framework/pytorch/cprofile/26-algo-1/train-0-stepstart-1657559947650317.0_train-0-forwardpassend-1657559957107843.8/python_stats.
1657559957244,[2022-07-11 17:19:17.210 algo-1:26 INFO python_profiler.py:182] Dumping cProfile stats to /opt/ml/output/profiler/framework/pytorch/cprofile/26-algo-1/train-0-forwardpassend-1657559957111961.5_train-1-stepstart-1657559957209072.8/python_stats.
1657560090284,"Epoch 0,#011 train loss: 14.0000, acc: 0.0000, best loss: 1000000.0000"
1657560105289,"Epoch 0,#011 valid loss: 7.0000, acc: 2.0000, best loss: 7.0000"
1657560229328,"Epoch 1,#011 train loss: 9.0000, acc: 1.0000, best loss: 7.0000"
1657560244333,"Epoch 1,#011 valid loss: 5.0000, acc: 2.0000, best loss: 5.0000"
1657560244333,Testing Model